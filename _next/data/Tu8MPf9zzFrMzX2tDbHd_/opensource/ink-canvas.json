{"pageProps":{"projectId":"ink-canvas","readmeContent":"# ink-canvas\n\nA library for rendering [Ink](https://github.com/vadimdemedes/ink) applications in the browser using [Xterm.js](https://xtermjs.org/).\n\n`ink-canvas` bridges the gap between Node.js-based CLI UIs built with Ink and web-based terminal emulators. It provides custom stream implementations and Node.js environment mocks that allow Ink to render directly into an Xterm.js instance running in a React application.\n\n**[Documentation Website](https://ink-canvas.byteland.app)**\n\n![License](https://img.shields.io/npm/l/ink-canvas)\n![Version](https://img.shields.io/npm/v/ink-canvas)\n\n## Features\n\n- üñ•Ô∏è **Browser Compatibility**: Run Ink applications entirely in the browser\n- üé® **Xterm.js Integration**: Leverages the power and styling of Xterm.js\n- üìê **Auto Resizing**: Automatically handles terminal resizing and layout fitting\n- ‚å®Ô∏è **Input Handling**: Captures keyboard input from the browser and forwards it to Ink\n- üåä **Custom Streams**: Built-in `stdout`, `stderr`, and `stdin` streams optimized for the browser\n- üîå **Vite Plugin**: Easy setup with automatic polyfill configuration\n\n## Table of Contents\n\n- [Installation](#installation)\n- [Quick Start](#quick-start)\n- [Configuration](#configuration)\n  - [Vite Configuration](#vite-configuration)\n  - [Polyfills Setup](#polyfills-setup)\n- [API Reference](#api-reference)\n  - [InkCanvas Component](#inkcanvas-component)\n  - [InkCanvasHandle](#inkcanvashandle)\n  - [inkCanvasPolyfills Plugin](#inkcanvaspolyfills-plugin)\n- [How It Works](#how-it-works)\n- [Examples](#examples)\n- [Troubleshooting](#troubleshooting)\n- [License](#license)\n\n## Installation\n\nInstall `ink-canvas` and its peer dependencies:\n\n```bash\n# npm\nnpm install ink-canvas ink react @xterm/xterm @xterm/addon-fit\n\n# yarn\nyarn add ink-canvas ink react @xterm/xterm @xterm/addon-fit\n\n# pnpm\npnpm add ink-canvas ink react @xterm/xterm @xterm/addon-fit\n```\n\n## Quick Start\n\nHere's a simple example to get you started:\n\n```tsx\nimport React, { useState } from \"react\";\nimport { Text, Box } from \"ink\";\nimport { InkCanvas } from \"ink-canvas\";\n\n// Your Ink application component\nconst MyInkApp = () => (\n  <Box borderStyle=\"round\" borderColor=\"green\">\n    <Text>Hello from Ink in the Browser! üëã</Text>\n  </Box>\n);\n\n// Main React component\nconst App = () => {\n  const [focused, setFocused] = useState(true);\n\n  return (\n    <div style={{ height: \"100vh\", width: \"100vw\" }}>\n      <InkCanvas\n        focused={focused}\n        terminalOptions={{\n          fontSize: 14,\n          theme: { background: \"#1a1b26\" },\n        }}\n      >\n        <MyInkApp />\n      </InkCanvas>\n    </div>\n  );\n};\n\nexport default App;\n```\n\n## Configuration\n\n### Vite Configuration\n\nTo use `ink-canvas` with Vite, you need to configure polyfills for Node.js globals. The easiest way is to use the provided `inkCanvasPolyfills` plugin:\n\n```typescript\n// vite.config.ts\nimport { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport { inkCanvasPolyfills } from \"ink-canvas/plugin\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    inkCanvasPolyfills(), // Add this plugin\n  ],\n});\n```\n\n### Webpack / Next.js Configuration\n\nFor Webpack-based projects like Next.js, use the `InkCanvasWebpackPlugin`. This plugin automatically configures module aliases, fallbacks, and provides global polyfills (process, Buffer) required by Ink.\n\n**Next.js Example (`next.config.mjs`):**\n\n```javascript\nimport { InkCanvasWebpackPlugin } from \"ink-canvas/plugin\";\n\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  transpilePackages: [\"ink-canvas\"], // Ensure ink-canvas is transpiled\n  webpack: (config, { isServer }) => {\n    // Only apply the plugin for client-side builds\n    if (!isServer) {\n      config.plugins.push(new InkCanvasWebpackPlugin());\n    }\n    return config;\n  },\n};\n\nexport default nextConfig;\n```\n\n**Standard Webpack Example (`webpack.config.js`):**\n\n```javascript\nconst { InkCanvasWebpackPlugin } = require(\"ink-canvas/plugin\");\n\nmodule.exports = {\n  // ...\n  plugins: [\n    new InkCanvasWebpackPlugin(),\n    // ... other plugins\n  ],\n};\n```\n\n### Polyfills Setup\n\nThe `inkCanvasPolyfills` plugin handles the following automatically:\n\n1. **Process Shim**: Redirects `node:process` imports to a browser-compatible shim\n2. **Buffer Polyfill**: Provides the `Buffer` global for binary data operations\n3. **Global Object**: Ensures the `global` object is available (maps to `globalThis`)\n\n#### Manual Polyfill Configuration\n\nIf you prefer to configure polyfills manually or are using a different build tool, you need to:\n\n1. **Install dependencies**:\n\n```bash\nnpm install vite-plugin-node-polyfills\n```\n\n2. **Configure your bundler** to alias `node:process` to the ink-canvas process shim:\n\n```typescript\n// vite.config.ts (manual configuration)\nimport { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport { nodePolyfills } from \"vite-plugin-node-polyfills\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    nodePolyfills({\n      exclude: [\"process\"], // We use our own process shim\n      globals: {\n        Buffer: true,\n        global: true,\n      },\n      protocolImports: true,\n    }),\n  ],\n  resolve: {\n    alias: {\n      \"node:process\": \"ink-canvas/shims/process\",\n    },\n  },\n});\n```\n\n#### Development Mode (Library Development)\n\nWhen developing the ink-canvas library itself, pass `true` to use local source files:\n\n```typescript\ninkCanvasPolyfills(true); // Uses local shims/process.ts\n```\n\n## API Reference\n\n### InkCanvas Component\n\nThe main component that wraps your Ink application.\n\n```tsx\nimport { InkCanvas } from \"ink-canvas\";\n```\n\n#### Props\n\n| Prop              | Type                                             | Default     | Description                                         |\n| ----------------- | ------------------------------------------------ | ----------- | --------------------------------------------------- |\n| `children`        | `ReactNode`                                      | -           | The Ink application to render                       |\n| `focused`         | `boolean`                                        | `false`     | Whether the terminal captures keyboard input        |\n| `cols`            | `number`                                         | `undefined` | Fixed number of columns. If omitted, fits container |\n| `rows`            | `number`                                         | `undefined` | Fixed number of rows. If omitted, fits container    |\n| `terminalOptions` | `ITerminalOptions`                               | `{}`        | Configuration for the Xterm.js instance             |\n| `onResize`        | `(dims: { cols: number, rows: number }) => void` | -           | Callback fired when terminal dimensions change      |\n| `...divProps`     | `HTMLAttributes<HTMLDivElement>`                 | -           | All other props are passed to the container `div`   |\n\n#### Terminal Options\n\nThe `terminalOptions` prop accepts all [Xterm.js ITerminalOptions](https://xtermjs.org/docs/api/terminal/interfaces/iterminaloptions/) except `disableStdin`. Common options include:\n\n```tsx\n<InkCanvas\n  terminalOptions={{\n    // Font settings\n    fontSize: 16,\n    fontFamily: \"JetBrains Mono, Fira Code, monospace\",\n    fontWeight: \"normal\",\n    fontWeightBold: \"bold\",\n\n    // Cursor settings\n    cursorStyle: \"bar\", // 'block' | 'underline' | 'bar'\n    cursorBlink: true,\n\n    // Theme (colors)\n    theme: {\n      background: \"#1a1b26\",\n      foreground: \"#a9b1d6\",\n      cursor: \"#c0caf5\",\n      cursorAccent: \"#1a1b26\",\n      selectionBackground: \"#33467c\",\n      black: \"#15161e\",\n      red: \"#f7768e\",\n      green: \"#9ece6a\",\n      yellow: \"#e0af68\",\n      blue: \"#7aa2f7\",\n      magenta: \"#bb9af7\",\n      cyan: \"#7dcfff\",\n      white: \"#a9b1d6\",\n    },\n\n    // Scrollback\n    scrollback: 1000,\n\n    // Other options\n    allowProposedApi: true,\n    convertEol: false,\n  }}\n>\n  <MyApp />\n</InkCanvas>\n```\n\n### InkCanvasHandle\n\nAccess the underlying terminal instance using a ref:\n\n```tsx\nimport { useRef } from \"react\";\nimport { InkCanvas, InkCanvasHandle } from \"ink-canvas\";\n\nconst App = () => {\n  const canvasRef = useRef<InkCanvasHandle>(null);\n\n  const handleClick = () => {\n    // Access the Xterm.js terminal\n    const terminal = canvasRef.current?.terminal;\n\n    // Get current dimensions\n    const dimensions = canvasRef.current?.dimensions;\n    console.log(`${dimensions?.cols}x${dimensions?.rows}`);\n\n    // Access the Ink instance\n    const inkInstance = canvasRef.current?.instance;\n  };\n\n  return (\n    <InkCanvas ref={canvasRef}>\n      <MyApp />\n    </InkCanvas>\n  );\n};\n```\n\n#### Handle Properties\n\n| Property     | Type                          | Description                             |\n| ------------ | ----------------------------- | --------------------------------------- |\n| `terminal`   | `Terminal \\| null`            | The Xterm.js Terminal instance          |\n| `dimensions` | `ITerminalDimensions \\| null` | Current terminal columns and rows       |\n| `instance`   | `Instance \\| null`            | The Ink instance returned by `render()` |\n\n### inkCanvasPolyfills Plugin\n\nA Vite plugin that configures all necessary polyfills.\n\n```typescript\nimport { inkCanvasPolyfills } from \"ink-canvas/plugin\";\n```\n\n#### Function Signature\n\n```typescript\nfunction inkCanvasPolyfills(dev?: boolean): Plugin[];\n```\n\n#### Parameters\n\n| Parameter | Type      | Default | Description                                                |\n| --------- | --------- | ------- | ---------------------------------------------------------- |\n| `dev`     | `boolean` | `false` | If true, uses local source paths (for library development) |\n\n#### Return Value\n\nReturns an array of Vite plugins:\n\n1. `vite-plugin-ink-canvas-polyfill`: Aliases `node:process` to the process shim\n2. `vite-plugin-node-polyfills`: Provides `Buffer` and `global` polyfills\n\n## How It Works\n\nInk is designed for Node.js environments and relies on `process.stdout`, `process.stdin`, and other system APIs. `ink-canvas` provides:\n\n### 1. Process Shim (`shims/process.ts`)\n\nA browser-compatible mock of Node.js's `process` object:\n\n- `process.env`: Mocked environment variables with sensible defaults\n- `process.stdout/stderr`: Minimal stream mocks with TTY properties\n- `process.stdin`: Input stream mock\n- `process.nextTick`: Implemented using `setTimeout`\n- Other properties: `platform`, `version`, `argv`, `cwd()`, etc.\n\n### 2. Custom Streams (`utils/streams.ts`)\n\n**TerminalWritableStream** (stdout/stderr):\n\n- Receives ANSI escape codes and text from Ink\n- Converts LF (`\\n`) to CRLF (`\\r\\n`) for proper Xterm.js rendering\n- Provides cursor manipulation methods (`cursorTo`, `moveCursor`, `clearLine`)\n- Emits `resize` events when terminal dimensions change\n\n**TerminalReadableStream** (stdin):\n\n- Captures keyboard input from Xterm.js `onData` events\n- Buffers input and emits `readable` events for Ink to consume\n- Supports raw mode for character-by-character input\n\n### 3. Canvas Component (`components/Canvas.tsx`)\n\nA wrapper component that:\n\n- Automatically sizes itself to match stdout dimensions\n- Listens for resize events and updates accordingly\n- Ensures Ink's layout fills the entire terminal viewport\n\n### 4. React Lifecycle Management (`components/InkCanvas.tsx`)\n\nThe InkCanvas component manages:\n\n- Xterm.js terminal initialization and cleanup\n- Stream creation and connection\n- Ink instance lifecycle (render, rerender, unmount)\n- Container auto-fitting with ResizeObserver\n- Focus state management\n\n## Examples\n\n### Basic Counter App\n\n```tsx\nimport { useState, useEffect } from \"react\";\nimport { Text, Box, useInput } from \"ink\";\nimport { InkCanvas } from \"ink-canvas\";\n\nconst Counter = () => {\n  const [count, setCount] = useState(0);\n\n  useInput((input, key) => {\n    if (input === \"+\" || key.upArrow) {\n      setCount((c) => c + 1);\n    } else if (input === \"-\" || key.downArrow) {\n      setCount((c) => c - 1);\n    } else if (input === \"q\") {\n      // Handle quit\n    }\n  });\n\n  return (\n    <Box flexDirection=\"column\" padding={1}>\n      <Text>Count: {count}</Text>\n      <Text dimColor>Press +/- or ‚Üë/‚Üì to change, q to quit</Text>\n    </Box>\n  );\n};\n\nconst App = () => (\n  <InkCanvas focused style={{ width: 400, height: 200 }}>\n    <Counter />\n  </InkCanvas>\n);\n```\n\n### Interactive List with Scrolling\n\n```tsx\nimport { useState } from \"react\";\nimport { Text, Box, useInput } from \"ink\";\nimport { InkCanvas } from \"ink-canvas\";\n\nconst items = Array.from({ length: 20 }, (_, i) => `Item ${i + 1}`);\n\nconst ScrollableList = () => {\n  const [selectedIndex, setSelectedIndex] = useState(0);\n\n  useInput((_, key) => {\n    if (key.upArrow) {\n      setSelectedIndex((i) => Math.max(0, i - 1));\n    } else if (key.downArrow) {\n      setSelectedIndex((i) => Math.min(items.length - 1, i + 1));\n    }\n  });\n\n  return (\n    <Box flexDirection=\"column\">\n      {items.map((item, index) => (\n        <Text\n          key={item}\n          color={index === selectedIndex ? \"green\" : undefined}\n          bold={index === selectedIndex}\n        >\n          {index === selectedIndex ? \"‚ùØ \" : \"  \"}\n          {item}\n        </Text>\n      ))}\n    </Box>\n  );\n};\n\nconst App = () => (\n  <InkCanvas focused style={{ width: \"100%\", height: \"400px\" }}>\n    <ScrollableList />\n  </InkCanvas>\n);\n```\n\n### Dynamic Resize Handling\n\n```tsx\nimport { useState } from \"react\";\nimport { Text, Box } from \"ink\";\nimport { InkCanvas } from \"ink-canvas\";\n\nconst ResizeDemo = () => {\n  const [size, setSize] = useState({ cols: 0, rows: 0 });\n\n  return (\n    <InkCanvas\n      focused\n      onResize={(dims) => setSize(dims)}\n      style={{ width: \"100%\", height: \"100vh\" }}\n    >\n      <Box borderStyle=\"single\" padding={1}>\n        <Text>\n          Terminal size: {size.cols} columns √ó {size.rows} rows\n        </Text>\n      </Box>\n    </InkCanvas>\n  );\n};\n```\n\n## Troubleshooting\n\n### Common Issues\n\n#### \"process is not defined\" or \"Cannot read properties of undefined (reading 'env')\"\n\nEnsure you have configured the polyfills correctly. Add `inkCanvasPolyfills()` to your Vite plugins:\n\n```typescript\n// vite.config.ts\nimport { inkCanvasPolyfills } from \"ink-canvas/plugin\";\n\nexport default defineConfig({\n  plugins: [react(), inkCanvasPolyfills()],\n});\n```\n\n#### Terminal not displaying / appears empty\n\nMake sure the container element has explicit dimensions:\n\n```tsx\n// ‚ùå Wrong - no dimensions\n<InkCanvas>\n  <MyApp />\n</InkCanvas>\n\n// ‚úÖ Correct - explicit dimensions via style\n<InkCanvas style={{ width: \"100%\", height: \"400px\" }}>\n  <MyApp />\n</InkCanvas>\n\n// ‚úÖ Correct - explicit dimensions via CSS class\n<InkCanvas className=\"terminal-container\">\n  <MyApp />\n</InkCanvas>\n```\n\n#### Keyboard input not working\n\nEnsure the `focused` prop is set to `true`:\n\n```tsx\n<InkCanvas focused={true}>\n  <MyApp />\n</InkCanvas>\n```\n\n#### Text wrapping incorrectly / layout issues\n\nThe terminal must be mounted before Ink can calculate layout. If you're seeing layout issues on initial render, try using the `onResize` callback to trigger a re-render:\n\n```tsx\nconst [ready, setReady] = useState(false);\n\n<InkCanvas onResize={() => setReady(true)}>{ready && <MyApp />}</InkCanvas>;\n```\n\n#### Build errors with TypeScript\n\nEnsure your `tsconfig.json` includes the necessary lib:\n\n```json\n{\n  \"compilerOptions\": {\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"]\n  }\n}\n```\n\n### Getting Help\n\nIf you encounter issues not covered here, please:\n\n1. Check the [GitHub Issues](https://github.com/ByteLandTechnology/ink-canvas/issues)\n2. Create a new issue with a minimal reproduction\n\n## License\n\nMIT\n","subPath":""},"__N_SSG":true}